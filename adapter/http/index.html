<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="zend-authentication">  
    <link rel="canonical" href="https://docs.zendframework.com/adapter/http/">
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>HTTP - zend-authentication - Zend Framework Docs</title>

    <link rel="stylesheet" href="/css/styles.css">
</head>
<body id="page-top">

    
    <div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">

            
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            
            <span class="navbar-brand">
                <a class="logo-link" href="https://framework.zend.com/" data-tooltip data-placement="bottom" title="Go to the ZF homepage">
                    <img src="../../img/zend-framework-logo.svg" height="28" alt="Zend Framework">
                </a>
            </span>
        </div>

        <div class="navbar-collapse collapse">

            
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="https://framework.zend.com/about">About</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/downloads">Install</a>
                </li>
                <li class="active">
                    <a href="https://docs.zendframework.com">Documentation</a>
                </li>
                <li>
                    <a href="https://www.zend.com/en/services/training">Training</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/blog">Blog</a>
                </li>
                <li>
                    <a href="https://framework.zend.com/participate">Participate</a>
                </li>
            </ul>

            
            
                <div class="nav navbar-nav navbar-collapse visible-xs-block ">
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../.." class="subnavigation__link">zend-authentication</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../intro/" class="subnavigation__link">Intro</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Adapters</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Intro</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">DbTable</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/intro/" class="subnavigation__link">Intro</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/credential-treatment/" class="subnavigation__link">CredentialTreatmentAdapter</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/callback-check/" class="subnavigation__link">CallbackCheck</a>
    </li>

            
        </ul>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../digest/" class="subnavigation__link">Digest</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">HTTP</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../ldap/" class="subnavigation__link">LDAP</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../storage/" class="subnavigation__link">Identity Persistence</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../validator/" class="subnavigation__link">Validation</a>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                </div>
            

            
            <div class="nav navbar-nav navbar-collapse visible-xs-block">
                <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
            </div>
        </div>
    </div>
</div>

    
    <header class="header">
    <div class="container">
        <div class="row">

            
            <div class="col-xs-8">
                <h1 class="header__title">
                    Documentation

                    
                        <small class="header__subtitle">zend-authentication</small>
                    
                </h1>
            </div>

            
            <div class="col-xs-4 text-right">
                
                    

                    <a href="#" class="header__link header__link--search" data-toggle="modal" data-target="#mkdocs_search_modal" title="Open search">
                        <i class="fa fa-search"></i> Search
                    </a>
                    <a href="https://github.com/zendframework/zend-authentication/" class="header__link header__link--github" title="Go to repository of zend-authentication">
                        <i class="fa fa-github"></i> GitHub
                    </a>
                
            </div>
        </div>
    </div>
</header>

    
    <div class="laminas-announcement">
    <div class="container">
        <div class="row">
            <div class="col-xs-12"><strong>
                This package has moved. Visit its replacement, <a href="https://docs.laminas.dev/laminas-authentication/">laminas/laminas-authentication.</a>
            </strong></div>
        </div>
    </div>
</div>

    
    <div class="container">
        <div class="row">
            <div class="col-md-9 col-xs-12 content" role="main">
            <!-- content:begin -->
                
                    <ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
    <li><a href="https://framework.zend.com/">Home</a></li>

    
        <li><a href="https://docs.zendframework.com/">Documentation</a></li>

        
            <li><a href="../..">zend-authentication</a></li>

            
                
                    
                    
                        <li>Adapters</li>
                    
                
            

            <li class="active">HTTP</li>
        
    
</ol>






    
    
        <h2 class="chapter__headline">Adapters</h2>
    

    <div>
        
    

    
    
        <div class="toc">
            <h6 class="toc__headline">In This Article</h6>
            <ul class="toc__list">
                
                    <li class="toc__entry">
                        <a href="#major-features" class="toc__link">Major Features</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#requirements" class="toc__link">Requirements</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#design-overview" class="toc__link">Design Overview</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#configuration-options" class="toc__link">Configuration Options</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#resolvers" class="toc__link">Resolvers</a>
                    </li>
                
                    <li class="toc__entry">
                        <a href="#basic-usage" class="toc__link">Basic Usage</a>
                    </li>
                
            </ul>
        </div>
    

    </div>

    <h1 id="http-authentication-adapter">HTTP Authentication Adapter</h1>
<p><code>Zend\Authentication\Adapter\Http</code> provides a mostly-compliant implementation of
<a href="http://tools.ietf.org/html/rfc2617">RFC-2617</a>,
<a href="http://en.wikipedia.org/wiki/Basic_authentication_scheme">Basic</a> and
<a href="http://en.wikipedia.org/wiki/Digest_access_authentication">Digest</a> HTTP
Authentication. Digest authentication is a method of HTTP authentication that
improves upon Basic authentication by providing a way to authenticate without
having to transmit the password in clear text across the network.</p>
<h2 id="major-features">Major Features</h2>
<ul>
<li>Supports both Basic and Digest authentication.</li>
<li>Issues challenges in all supported schemes, so client can respond with any
  scheme it supports.</li>
<li>Supports proxy authentication.</li>
<li>Includes support for authenticating against text files and provides an
  interface for authenticating against other sources, such as databases.</li>
</ul>
<p>There are a few notable features of RFC-2617 that are not implemented yet:</p>
<ul>
<li>Nonce tracking, which would allow for "stale" support, and increased replay
  attack protection.</li>
<li>Authentication with integrity checking, or "auth-int".</li>
<li>Authentication-Info HTTP header.</li>
</ul>
<h2 id="requirements">Requirements</h2>
<p>The HTTP authentication adapter requires <a href="https://github.com/zendframework/zend-http">zend-http</a>
in order to do its work:</p>
<pre><code class="language-bash">$ composer require zendframework/zend-http
</code></pre>

<h2 id="design-overview">Design Overview</h2>
<p>This adapter consists of two sub-components, the HTTP authentication class
itself, and its "Resolvers." The HTTP authentication class encapsulates the
logic for carrying out both Basic and Digest authentication. It consumes
Resolvers to look up a client's identity in some data store (text file by
default), and retrieve the credentials from the data store. The "resolved"
credentials are then compared to the values submitted by the client to
determine whether authentication is successful.</p>
<h2 id="configuration-options">Configuration Options</h2>
<p><code>Zend\Authentication\Adapter\Http</code> requires a configuration array passed to its
constructor. There are several configuration options available, and some are
required:</p>
<div class="table-responsive"><table>
<thead>
<tr>
<th>Option Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>accept_schemes</code></td>
<td>Yes</td>
<td>Determines which authentication schemes the adapter will accept from the client. Must be a space-separated list containing <code>basic</code> and/or <code>digest</code>.</td>
</tr>
<tr>
<td><code>realm</code></td>
<td>Yes</td>
<td>Sets the authentication realm; usernames should be unique within a given realm.</td>
</tr>
<tr>
<td><code>digest_domains</code></td>
<td>Yes, when <code>accept_schemes</code> contains digest</td>
<td>Space-separated list of URIs for which the same authentication information is valid. The URIs need not all point to the same server.</td>
</tr>
<tr>
<td><code>nonce_timeout</code></td>
<td>Yes, when <code>accept_schemes</code> contains digest</td>
<td>Sets the number of seconds for which the nonce is valid. See notes below.</td>
</tr>
<tr>
<td><code>use_opaque</code></td>
<td>No</td>
<td>Specifies whether to send the opaque value in the header. True by default.</td>
</tr>
<tr>
<td><code>algorithm</code></td>
<td>No</td>
<td>Specified the algorithm. Defaults to MD5, the only supported option (for now).</td>
</tr>
<tr>
<td><code>proxy_auth</code></td>
<td>No</td>
<td>Disabled by default. Enable to perform Proxy authentication, instead of normal origin server authentication.</td>
</tr>
</tbody>
</table></div>
<blockquote>
<h3>nonce timeout</h3>
<p>The current implementation of the <code>nonce_timeout</code> has some interesting side
effects. This setting is supposed to determine the valid lifetime of a given
nonce, or effectively how long a client's authentication information is
accepted. As an example, if it's set to 3600, it will cause the adapter to
prompt the client for new credentials every hour, on the hour.  This will be
resolved in a future release, once nonce tracking and stale support are
implemented.</p>
</blockquote>
<h2 id="resolvers">Resolvers</h2>
<p>A resolver's job is to take a username and realm, and return some kind of
credential value. Basic authentication expects to receive the base64-encoded
version of the user's password. Digest authentication expects to receive a hash
of the user's username, the realm, and their password (each separated by
colons). Currently, the only supported hash algorithm is MD5.</p>
<p><code>Zend\Authentication\Adapter\Http</code> relies on objects implementing
<code>Zend\Authentication\Adapter\Http\ResolverInterface</code>. The component includes
resolvers for plain text files and Apache <code>htpasswd</code>-generated files; you can
also provide your own implementations.</p>
<h3>File Resolver</h3>
<p>The file resolver is a very simple class. It has a single property specifying a
filename, which can also be passed to the constructor. Its <code>resolve()</code> method
walks through the text file, searching for a line with a matching username and
realm. The text file format is similar to Apache <code>htpasswd</code> files:</p>
<pre><code class="language-text">&lt;username&gt;:&lt;realm&gt;:&lt;credentials&gt;
</code></pre>

<p>Each line consists of three fields &mdash; username, realm, and credentials
&mdash; each separated by a colon.  The credentials field is opaque to the file
resolver; it simply returns that value as-is to the caller. Therefore, this
same file format serves both Basic and Digest authentication. In Basic
authentication, the credentials field should be written in clear text. In
Digest authentication, it should be the MD5 hash described above.</p>
<p>There are two ways to create a file resolver:</p>
<pre><code class="language-php">use Zend\Authentication\Adapter\Http\FileResolver;

$path     = 'data/passwd.txt';
$resolver = new FileResolver($path);
</code></pre>

<p>or</p>
<pre><code class="language-php">$path     = 'data/passwd.txt';
$resolver = new FileResolver();
$resolver-&gt;setFile($path);
</code></pre>

<p>If the given path is empty or not readable, an exception is thrown.</p>
<h3>Apache Resolver</h3>
<p><code>Zend\Authentication\Adapter\Http\ApacheResolver</code> operates similarly to the
<code>FileResolver</code>, but is capable of reading files generated by Apache's <code>htpasswd</code>
facility, as described in the <a href="http://httpd.apache.org/docs/current/misc/password_encryptions.html">Apache documentation</a>.</p>
<p>In order to do so, you will need to also install <a href="http://docs.zendframework.com/zend-crypt/">zend-crypt</a>:</p>
<pre><code class="language-bash">$ composer require zendframework/zend-crypt
</code></pre>

<p>In all other ways, it behaves like the <code>FileResolver</code>, meaning you instantiate
it with a path to the <code>htpasswd</code>-generated file, or inject the path after
instantiation:</p>
<pre><code class="language-php">use Zend\Authentication\Adapter\Http\ApacheResolver;

$path = 'data/htpasswd';

// Inject at instantiation:
$resolver = new ApacheResolver($path);

// Or afterwards:
$resolver = new ApacheResolver();
$resolver-&gt;setFile($path);
</code></pre>

<h2 id="basic-usage">Basic Usage</h2>
<p>First, set up an array with the required configuration values:</p>
<pre><code class="language-php">$config = [
    'accept_schemes' =&gt; 'basic digest',
    'realm'          =&gt; 'My Web Site',
    'digest_domains' =&gt; '/members_only /my_account',
    'nonce_timeout'  =&gt; 3600,
];
</code></pre>

<p>This array will cause the adapter to accept either Basic or Digest
authentication, and will require authenticated access to all the areas of the
site under <code>/members_only</code> and <code>/my_account</code>. The realm value is usually
displayed by the browser in the password dialog box. The <code>nonce_timeout</code>
behaves as described above.</p>
<p>Next, create the <code>Zend\Authentication\Adapter\Http</code> object:</p>
<pre><code class="language-php">use Zend\Authentication\Adapter\Http;

$adapter = new Http($config);
</code></pre>

<p>Since we're supporting both Basic and Digest authentication, we need two
different resolver objects.</p>
<pre><code class="language-php">use Zend\Authentication\Adapter\Http\FileResolver;

$basicResolver  = new FileResolver('data/basic-passwd.txt');
$digestResolver = new FileResolver('data/digest-passwd.txt');

$adapter-&gt;setBasicResolver($basicResolver);
$adapter-&gt;setDigestResolver($digestResolver);
</code></pre>

<p>Finally, we perform authentication. The adapter requires zend-http request and
response instances in order to lookup credentials and provide challenge responses:</p>
<pre><code class="language-php">use Zend\Http\Request;
use Zend\Http\Response;

// $request is an instance of Request
// $response is an instance of Response
$adapter-&gt;setRequest($request);
$adapter-&gt;setResponse($response);

$result = $adapter-&gt;authenticate();
if (! $result-&gt;isValid()) {
    // Bad username/password, or canceled password prompt
}
</code></pre>




    <nav>
    <ul class="page-nav hidden-print">

        
        <li class="page-nav__item">
            
                <a rel="prev" class="page-nav__link page-nav__link--prev" href="../digest/">
                    <i class="fa fa-chevron-left"></i> Previous
                </a>
            
        </li>

        
        <li class="page-nav__item">
            
                <a rel="next" class="page-nav__link page-nav__link--next" href="../ldap/">
                    Next <i class="fa fa-chevron-right"></i>
                </a>
            
        </li>
    </ul>
</nav>




    <div class="help-wanted">
        <p>
            Found a mistake or want to contribute to the documentation?
            <a href="https://github.com/zendframework/zend-authentication/edit/master/docs/book/adapter/http.md" target="_blank" class="help-wanted__link">
                Edit this page on GitHub!
            </a>
        </p>
    </div>

                
            <!-- content:end -->
            </div>
            <div class="col-md-3 col-xs-12 sidebar">
                
                    <div class="component-selector">
    <h4 class="component-selector__title">Components</h4>
    <h5 class="component-selector__subtitle">Find documentationâ€¦</h5>
    <select class="form-control component-selector__control">
        <option value="/">Overview</option>
        <optgroup label="Components"></optgroup>
    </select>
</div>
                    
    <div class="subnavigation hidden-print">
        <h4 class="subnavigation__title">
            <a href="../..">zend-authentication</a>
        </h4>

        <h5 class="subnavigation__subtitle">Table of Contents</h5>

        <ul class="subnavigation__list">
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../.." class="subnavigation__link">zend-authentication</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../intro/" class="subnavigation__link">Intro</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item">
                                <span class="subnavigation__headline">Adapters</span>
                                <ul class="subnavigation__list">
                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../intro/" class="subnavigation__link">Intro</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item">
        <span class="subnavigation__headline">DbTable</span>
        <ul class="subnavigation__list">
            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/intro/" class="subnavigation__link">Intro</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/credential-treatment/" class="subnavigation__link">CredentialTreatmentAdapter</a>
    </li>

            
                
    <li class="subnavigation__list-item ">
        <a href="../dbtable/callback-check/" class="subnavigation__link">CallbackCheck</a>
    </li>

            
        </ul>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../digest/" class="subnavigation__link">Digest</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item subnavigation__list-item--active">
        <a href="./" class="subnavigation__link">HTTP</a>
    </li>

                                    
                                        
    <li class="subnavigation__list-item ">
        <a href="../ldap/" class="subnavigation__link">LDAP</a>
    </li>

                                    
                                </ul>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../storage/" class="subnavigation__link">Identity Persistence</a>
                            </li>
                        
                    
                
            

                
                

                    
                    
                        
                            <li class="subnavigation__list-item ">
                                <a href="../../validator/" class="subnavigation__link">Validation</a>
                            </li>
                        
                    
                
            
        </ul>
    </div>

                
            </div>
        </div>
    </div>

    
    <footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-9">
                <h5>Zend Framework</h5>
                <ul>
                    <li><a href="https://framework.zend.com/">framework.zend.com</a></li>
                    <li><a href="https://docs.zendframework.com">docs.zendframework.com</a></li>
                    <li><a href="https://packages.zendframework.com">packages.zendframework.com</a></li>
                    <li><a href="https://apigility.org">apigility.org</a></li>
                    <li><a href="https://getexpressive.org/">getexpressive.org</a></li>
                </ul>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-12 text-center">
                <a class="footer__button" href="#page-top"><i class="fa fa-chevron-up" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="row">

            
            <div class="col-md-9">
                <h4 class="footer__headline">Copyright</h4>
                <p>&copy; 2006-2020 by <a href="https://www.zend.com/">Zend</a> by <a href="https://www.perforce.com/">Perforce</a>.</p>
            </div>

            
            <div class="col-md-3">
                <h4 class="footer__headline">Support</h4>
                <ul class="support__list">
                    <li class="support__list-item">
                        <a href="https://discourse.laminas.dev" class="support__link" title="Forum"><i class="fa fa-comments"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://laminas.dev/chat/" class="support__link" title="Chat"><i class="fa fa-slack"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://github.com/zendframework" class="support__link" title="Github"><i class="fa fa-github"></i></a>
                    </li>
                    <li class="support__list-item">
                        <a href="https://twitter.com/zfdevteam" class="support__link" title="Twitter"><i class="fa fa-twitter"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>

<nav class="cookie-bar navbar navbar-fixed-bottom navbar-default hidden">
    <div class="container">
        <p class="navbar-text">
            We use cookies to allow you to dismiss dialogs such as the Laminas
            Project notification.
        </p>
        <button type="button" class="cookie-button btn btn-default navbar-btn">Allow Cookies</button>
    </div>
</nav>

    <script>
        var base_url = '../..',
            siteName = 'zend-authentication';
    </script>
    <script src="/js/scripts.js"></script>
    <script src="../../search/main.js"></script>

    
    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>



</body>


</html>
